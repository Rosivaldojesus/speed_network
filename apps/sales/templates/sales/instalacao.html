{% extends 'base.html' %}
{% load static %}


<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

{% block main %}
<div class="container">
    <div class="mt-2" align="right">
        <a class="btn btn-primary" href="cadastro-instalacao/">Adicionar Instalação</a>
    </div>

    <!-- Messagens -->
    {% if messages %}
    {% for message in messages %}
        <div class="alert {{ message.tags }}" role="alert">
            {{ message }}
        </div>
      {% endfor %}
      {% endif %}

       <!-- STATUS DOS INSTALAÇÃO -->
    <h5 class="mt-3">Status Instalações</h5>

      {% if request.user.groups.all.0.name == "Adm" or request.user.groups.all.0.name == "Master" %} 
      <div class="card-deck">
      
        <div class="card border-danger" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Aberto</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{quant_aberta}}</strong></div>
            </div>
          </div>
          <div class="card-footer border-danger">
            <a href="instalacao-aberta/" class="btn btn-danger">Ver todos</a>
          </div>
        </div>
  
        <div class="card border-warning" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Agendado</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{quant_agendada}}</strong></div>
            </div>
          </div>
          <div class="card-footer border-warning">
            <a href="instalacao-agendada/" class="btn btn-warning text-white">Ver todos</a>
          </div>
        </div>
  
        <div class="card border-dark" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Finalizados sem boleto</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{ quant_sem_boleto }}</strong></div>
            </div>
          </div>
          <div class="card-footer border-dark">
            <a href="instalacao-finalizada-sem-boleto/" class="btn btn-dark">Ver todos</a>
          </div>
        </div>
  
  
        <div class="card border-success" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Finalizados</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{quant_concluida}}</strong></div>
            </div>
          </div>
          <div class="card-footer border-success">
            <a href="instalacao-concluida/" class="btn btn-success">Ver todos</a>
          </div>
        </div>
  
      {% elif request.user.groups.all.0.name == "Tecnico" %}
      <div class="card-deck">
      
        <div class="card border-danger" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Aberto</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{quant_aberta}}</strong></div>
            </div>
          </div>
          <div class="card-footer border-danger">
            <a href="instalacao-aberta/" class="btn btn-danger">Ver todos</a>
          </div>
        </div>
  
        <div class="card border-warning" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Agendado</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{quant_agendada}}</strong></div>
            </div>
          </div>
          <div class="card-footer border-warning">
            <a href="instalacao-agendada/" class="btn btn-warning text-white">Ver todos</a>
          </div>
        </div>
          {% elif request.user.groups.all.0.name == "Venda" %}
        <div class="card-deck">

        <div class="card border-danger" align="center">
            <div class="card-group">
              <div class="card border-0">
                <h5>Aberto</h5>
              </div>
              <div class="card border-0">
                <div class="display-4"><strong>{{quant_aberta_vendedor}}</strong></div>
              </div>
            </div>
            <div class="card-footer border-danger">
              <a href="instalacao-aberta/" class="btn btn-danger">Ver todos</a>
            </div>
        </div>

        <div class="card border-warning" align="center">
          <div class="card-group">
            <div class="card border-0">
              <h5>Agendado</h5>
            </div>
            <div class="card border-0">
              <div class="display-4"><strong>{{quant_agendada_vendedor}}</strong></div>
            </div>
          </div>
          <div class="card-footer border-warning">
            <a href="instalacao-agendada/" class="btn btn-warning text-white">Ver todos</a>
          </div>
        </div>
      </div> 
      <hr>
      <hr> 
      <!--
      {% for instalacaoVendedor in instalacaoVendedor %}
        {{ instalacaoVendedor.nome_cliente }} <br>
      {% endfor %}
      -->  
    {% endif %}
      </div>
        <hr>
        <hr>


      <!--Total de instalaçãoes mensais-->  
    <div>
      <h5>Instalações Mensais</h5>
          {% for mensal in mensalInstalacao %}
            {{ mensal.month|date:"F Y"  }}: {{ mensal.c }}<br>
          {% endfor %}
    </div>

    <!--Total de instalações por dia -->
    <hr>
        <hr>
    <div>
      <h5>Instalações Diárias</h5>
      {% for diario in diarioInstalaçao %}
        {{ diario.data_finalizacao}}: {{ diario.number}} <br>
      {% endfor %}
    </div>












        <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>


        <style>
          

        body {
          font-family: Roboto, sans-serif;
        }

        #chart {
          max-width: 650px;
          margin: 35px auto;
        }

        </style>

        <div id="chart"></div>


        <script>
       var options = {
          series: [{
          name: 'Servings',
          data: [44, 55, 41, 67, 22, 43, 21, 33, 45, 31, 87, 65, 35]
        }],
          annotations: {
          points: [{
            x: 'Bananas',
            seriesIndex: 0,
            label: {
              borderColor: '#775DD0',
              offsetY: 0,
              style: {
                color: '#fff',
                background: '#775DD0',
              },
              text: 'Bananas are good',
            }
          }]
        },
        chart: {
          height: 350,
          type: 'bar',
        },
        plotOptions: {
          bar: {
            borderRadius: 10,
            columnWidth: '50%',
          }
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          width: 2
        },
        
        grid: {
          row: {
            colors: ['#fff', '#f2f2f2']
          }
        },
        xaxis: {
          labels: {
            rotate: -45
          },
          categories: [
         ' {% for mensal in instalacoesMensais %}
            {{ mensal.month }}: {{ mensal.count }}<br>
          {% endfor %}'
          
          'Apples', 
          ],
          tickPlacement: 'on'
        },
        yaxis: {
          title: {
            text: 'Servings',
          },
        },
        fill: {
          type: 'gradient',
          gradient: {
            shade: 'light',
            type: "horizontal",
            shadeIntensity: 0.25,
            gradientToColors: undefined,
            inverseColors: true,
            opacityFrom: 0.85,
            opacityTo: 0.85,
            stops: [50, 0, 100]
          },
        }
        };

        var chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
        </script>
      
      
  
</div>

{% endblock %}