{% extends 'base.html' %}
{% load static %}
{% block title %}.:: Instalações  agendadas {% endblock %}

{% block main %}
<div class="container-xl">
  {% if request.user.groups.all.0.name == "Adm" or request.user.groups.all.0.name == "Master" %}
  <!-- INÍCIO  Campo de Pesquisas-->
	<div class="mt-3 fundo-card">
		<form method="GET" class="texto-cor-2 p-2">
      <p>Escolha apenas das opções para pesquisa.</p>
		   <div class="row">
       
			   <div class="form-group col-8">
				   <input type="search" class="form-control" placeholder="Informe o nome do cliente"
						  name="q" value="{{ request.GET.q }}">
			   </div>
              
         <div class="form-group col-4">
          <input type="date" class="form-control" placeholder="Data"
             name="data_dia" value="{{ request.GET.data_dia }}">
        </div>   
		  </div>

      <div align="right">
				<button type="submit" class="btn btn-success">Executar Pesquisa</button>
			</div>
	  </form>
	</div>
	<!-- FIM Campo de Pesquisas-->

  <!-- INÍCIO Messagens -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert {{ message.tags }}" role="alert">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}      
  <!-- FIM Messagens -->

  <div>
    <h2 class="mt-3 mb-3 texto-cor-2"><span class="badge badge-warning badge-pill">{{quant_agendada}} </span> Instalações Agendadas </h2>
  </div>

  <!-- INÍCIO da lista de instalaçoes agendas-->
  {% for agendada in agendadas %} 
  <div class="card mt-2 mb-2 fundo-card texto-cor-2">
    <div class="row">
      <div class="col-sm-9">
        <div class="card border-0 mt-2 mb-2 ml-2 fundo-card">
          <div class="fundo-card">
            <small ><strong>Nome:</strong></small><br>
                {{ agendada.nome_cliente }} {{ agendada.sobrenome_cliente }}<br>
              <small><strong>Rua:</strong></small><br>  
                {{ agendada.rua_cliente }}, {{ agendada.numero_endereco_cliente }}<br>
              <small><strong>Bairro:</strong></small><br>
                {{ agendada.bairro_cliente }}<br> 
              <small><strong>Data Instalação:</strong></small><br>  
                {{ agendada.data_instalacao }}  às {{ agendada.hora_instalacao }}<br>
              <small><strong>Observação:</strong></small><br>  
                {{ agendada.observacao_instalacao }}<br> 
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="card border-0 mt-2 mb-2 ml-2 fundo-card">
          <div>
            <div class="fundo-card>
              <a href="/vendas/finalizar-instalacao/{{ agendada.id }}" class="btn btn-success">Finalizar</a>
              <a href="/vendas/definir-tecnico_instalacao/{{ agendada.id }}" title="Escolher Técnico"><i class="fas fa-users-cog fa-2x"></i></a>
              <a href="editar-instalacao/{{ agendada.id }}" title="Editar" style="color:gold;"><i class="fas fa-edit fa-2x"></i></a>
              <a href="visualizar-instalacao/?id={{ agendada.id }}" title="Visualizar"><i class="fas fa-eye fa-2x"></i></a>
              <a href="/vendas/deletar-instalacao-agendada/{{ agendada.id }}" title="Excluir" style="color:tomato;"><i class="fas fa-trash-alt fa-2x"></i></a>
                <div>
                  {% if agendada.funcionario_instalacao is null %}
                  <p style="color:red;">Por favor, defina um responsável pela instalação.</p>
                  {% else %}
                  <p>Responsável pela Instalação: <strong>{{ agendada.funcionario_instalacao.get_full_name }}</strong></p>
                  {% endif %}
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %} 
  <!-- FIM da lista de instalaçoes agendas-->
      
  {%endif %}    
</div>
{% endblock %}